# Ознакомление с кодом проекта

## Функциональность Mesto
- Загрузка фотографий.
- Удаление фотографий.
- Сбор и учет лайков под фото.
- Создание профиля и его редактирование.

## 1. Структура проекта

```
/architecture
├── /src
│     ├── /blocks
│     │     ├── /auth-form
│     │     │     ├── /__button
│     │     │     │     └── auth-form__button.css
│     │     │     ├── /__form
│     │     │     │     └── auth-form__form.css
│     │     │     ├── /__input
│     │     │     │     └── auth-form__input.css
│     │     │     ├── /__link
│     │     │     │     └── auth-form__link.css
│     │     │     ├── /__text
│     │     │     │     └── auth-form__text.css
│     │     │     ├── /__textfield
│     │     │     │     └── auth-form__textfield.css
│     │     │     ├── /__title
│     │     │     │     └── auth-form__title.css
│     │     │     └── auth-form.css
│     │     ├── /card
│     │     │     ├── /__delete-button
│     │     │     │     ├── /_hidden
│     │     │     │     │     └── card__delete-button_hidden.css
│     │     │     │     ├── /_visible
│     │     │     │     │     └── card__delete-button_visible.css
│     │     │     │     └── card__delete-button.css
│     │     │     ├── /__description
│     │     │     │     └── card__description.css
│     │     │     ├── /__image
│     │     │     │     └── card__image.css
│     │     │     ├── /__like-button
│     │     │     │     └── /_is-active
│     │     │     │     │     └── card__like-button_is-active.css
│     │     │     │     └── card__like-button.css
│     │     │     ├── /__like-count
│     │     │     │     └── card__like-count.css
│     │     │     ├── /__title
│     │     │     │     └── card__title.css
│     │     │     └── card.css
│     │     ├── /content 
│     │     │     └── content .css
│     │     ├── /footer 
│     │     │     ├── /__copyright
│     │     │     │     └── footer__copyright.css
│     │     │     └── footer .css
│     │     ├── /header 
│     │     │     ├── /__auth-link
│     │     │     │     └── header__auth-link.css
│     │     │     ├── /__logo
│     │     │     │     └── header__logo.css
│     │     │     ├── /__logout
│     │     │     │     └── header__logout.css
│     │     │     ├── /__user
│     │     │     │     └── header__user.css
│     │     │     ├── /__wrapper
│     │     │     │     └── header__wrapper.css
│     │     │     └── header .css
│     │     ├── /login
│     │     │     └── login .css
│     │     ├── /page
│     │     │     ├── /__content
│     │     │     │     └── page__content.css
│     │     │     ├── /__section
│     │     │     │     └── page__section.css
│     │     │     └── page .css
│     │     ├── /places
│     │     │     ├── /__item
│     │     │     │     └── places__item.css
│     │     │     ├── /__list
│     │     │     │     └── places__list.css
│     │     │     └── places .css
│     │     ├── /popup
│     │     │     ├── /__button
│     │     │     │     ├── /_disabled
│     │     │     │     │     └── popup__button_disabled.css
│     │     │     │     └── popup__button.css
│     │     │     ├── /__caption
│     │     │     │     └── popup__caption.css
│     │     │     ├── /__close
│     │     │     │     └── popup__close.css
│     │     │     ├── /__content
│     │     │     │     ├── /_content
│     │     │     │     │     └── popup__content_content_image.css
│     │     │     │     └── popup__content.css
│     │     │     ├── /__error
│     │     │     │     ├── /_visible
│     │     │     │     │     └── popup__error_visible.css
│     │     │     │     └── popup__error.css
│     │     │     ├── /__form
│     │     │     │     └── popup__form.css
│     │     │     ├── /__icon
│     │     │     │     └── popup__icon.css
│     │     │     ├── /__image
│     │     │     │     └── popup__image.css
│     │     │     ├── /__input
│     │     │     │     ├── /_type
│     │     │     │     │     └── popup__input_type_error.css
│     │     │     │     └── popup__input.css
│     │     │     ├── /__label
│     │     │     │     └── popup__label.css
│     │     │     ├── /__status-message
│     │     │     │     └── popup__status-message.css
│     │     │     ├── /__title
│     │     │     │     └── popup__title.css
│     │     │     ├── /__is-opened
│     │     │     │     └── popup__is-opened.css
│     │     │     ├── /__type
│     │     │     │     ├── popup_type_edit-avatar.css
│     │     │     │     └── popup_type_remove-card.css
│     │     │     └── popup .css 
│     │     ├── /profile
│     │     │     ├── /__add-button
│     │     │     │     └── profile__add-button.css
│     │     │     ├── /__description
│     │     │     │     └── profile__description.css
│     │     │     ├── /__edit-button
│     │     │     │     └── profile__edit-button.css
│     │     │     ├── /__image
│     │     │     │     └── profile__image.css
│     │     │     ├── /__info
│     │     │     │     └── profile__info.css
│     │     │     ├── /__title
│     │     │     │     └── profile__title.css
│     │     │     └── profile .css     
│     ├── /components
│     │     ├── AddPlacePopup.js  
│     │     ├── App.js
│     │     ├── Card.js 
│     │     ├── EditAvatarPopup.js
│     │     ├── EditProfilePopup.js
│     │     ├── Footer.js
│     │     ├── Header.js
│     │     ├── ImagePopup.js
│     │     ├── InfoTooltip.js
│     │     ├── Login.js 
│     │     ├── Main.js
│     │     ├── PopupWithForm.js
│     │     ├── ProtectedRoute.js    
│     │     └── Register.js        
│     ├── /contexts
│     │     └── CurrentUserContext.js               
│     ├── /images
│     │     ├── add-icon.svg
│     │     ├── avatar.jpg
│     │     ├── card_1.jpg
│     │     ├── card_2.jpg
│     │     ├── card_3.jpg
│     │     ├── close.svg
│     │     ├── delete-icon.svg
│     │     ├── edit-icon.svg
│     │     ├── error-icon.svg
│     │     ├── like-active.svg
│     │     ├── like-inactive.svg
│     │     ├── logo.svg
│     │     └── success-icon.svg             
│     ├── /utils
│     │     ├── api.js
│     │     └── auth.js                  
│     ├── /vendor
│     │     ├── /fonts
│     │     │     ├── Inter-Black.woff2
│     │     │     └── Inter-Regular.woff2
│     │     ├── fonts.css     
│     │     └── normalize.css
│     ├── index.css
│     ├── index.js
│     ├── logo.svg
│     ├── serviceWorker.js
│     └── setupTests.js
├── index.spec.js                       
└── package.json                        
```
Основные директории проекта:

**src** — корневая директория исходного кода приложения. В ней находятся все основные файлы и папки проекта:
- `blocks` — содержит стили компонентов, организованные по методологии БЭМ (Блок, Элемент, Модификатор). Здесь каждая папка соответствует отдельному блоку, а внутри находятся стили этого блока.
- `components` — содержит React-компоненты, используемые в приложении. Каждый компонент отвечает за определенную функциональность или часть интерфейса.
- `contexts` — хранит файлы контекстов. В данном случае это `CurrentUserContext.js`.
- `images` — содержит изображения и иконки, используемые в приложении.
- `utils` — утилитарные файлы и функции, такие как `api.js` для взаимодействия с сервером и `auth.js` для аутентификации пользователей.
- `vendor` — сторонние ресурсы, такие как шрифты (`fonts`) и стили сброса (`normalize.css`).
- `index.css` — главный файл стилей приложения.
- `index.js` — точка входа в приложение, где происходит рендеринг корневого компонента `App` в DOM.

## 2. Компоненты и модули
**Компоненты высшего уровня:**
- `App.js` — главный компонент приложения, который управляет состоянием и маршрутизацией. Он оборачивает всё приложение в контекст `CurrentUserContext.Provider` и содержит логику для авторизации, взаимодействия с API и управления состоянием модальных окон.
- `Header.js, Main.js, Footer.js` — компоненты, отвечающие за структуру страницы: заголовок, основной контент и подвал соответственно.

**Взаимодействие компонентов:**
- `App.js` импортирует и использует множество дочерних компонентов, передавая им необходимые пропсы и состояние. Например, `Main` получает пропсы `cards`, `onEditProfile`, `onAddPlace` и другие для управления соответствующими действиями.
- Контекст `CurrentUserContext` позволяет дочерним компонентам получать данные о текущем пользователе без необходимости пробрасывать их через все уровни компонентов.
- Модальные окна: компоненты, такие как `EditProfilePopup`, `AddPlacePopup`, `EditAvatarPopup`, `ImagePopup` и `InfoTooltip`, используются для отображения модальных окон. Они получают пропсы `isOpen`, `onClose` и другие для управления видимостью и поведением.

**Работа с API и авторизацией:**
- `api.js` — содержит классы и методы для взаимодействия с сервером: получение и обновление данных пользователя, загрузка фотографий, управление лайками и т.д.
- `auth.js` — отвечает за регистрацию, вход и проверку токена пользователя.

## 3. Маршрутизация
- В проекте используется библиотека `React Router` для настройки маршрутизации между разными страницами приложения. Маршруты определяются в файле App.js.
- Компонент `Switch` в `App.js` определяет маршруты:
  - для главной страницы (`/`), 
  - регистрации (`/signup`)
  - входа (`/signin`).
- `ProtectedRoute.js` — компонент, который защищает маршруты, требующие авторизации. Он проверяет, авторизован ли пользователь, и перенаправляет на страницу входа при необходимости.
- Хук useHistory из react-router-dom используется для программной навигации. Например, после успешной авторизации или регистрации пользователь перенаправляется на определенную страницу
- `InfoTooltip.js` — Компонент для отображения информационных сообщений пользователю, например, об успешной регистрации или ошибке. 
- `Header.js и Footer.js` — Отображаются на всех страницах приложения. `Header` может показывать информацию о пользователе или ссылки на вход/регистрацию в зависимости от состояния авторизации.

## 4. Зависимости проекта:
Файл `package.json` содержит список зависимостей и пакетов, используемых в проекте.

- **Основные библиотеки**:
    - React и React DOM для построения интерфейса.
    - React Router DOM для маршрутизации.
    - Testing Library для написания тестов.

- **Управление состоянием**:
    - Реализовано с помощью встроенных хуков и контекста React.

- **Тестирование**:
    - Используются библиотеки Testing Library и Playwright для написания юнит-тестов и энд-ту-энд тестирования.

- **Прочие утилиты**:
    - Dotenv для управления переменными окружения.
    - Wait-port для синхронизации запуска сервисов.

**P.S. о зависимостях:**

- Версии библиотек указаны с использованием символа каретки (`^`), что означает, что при установке будут использоваться последние минорные и патч-версии, совместимые с указанной мажорной версией.
- Отсутствие внешних библиотек для управления состоянием говорит о том, что приложение не требует сложного управления состоянием и достаточно возможностей, предоставляемых React "из коробки".

## 5. Утилиты и вспомогательные функции
В проекте есть две основные утилиты, расположенные в папке `utils`:

1. `api.js` — отвечает за взаимодействие с сервером по REST API для получения и изменения фото и информации о пользователе.
2. `auth.js` — управляет аутентификацией пользователей: регистрация, вход в систему и проверка токена.

### **Общие функции утилит и их роль в проекте**

- **`api.js`**:
  - **Централизация запросов к серверу**: все операции с данными осуществляются через методы этого класса, что упрощает код и делает его более читаемым.
  - **Унификация обработки ответов и ошибок**: в каждом методе используется единообразная обработка результатов, что облегчает отладку и поддержку.
  - **Повторное использование кода**: компоненты не дублируют логику запросов, а вызывают готовые методы из `api`.

- **`auth.js`**:
  - **Управление аутентификацией**: сосредоточивает всю логику, связанную с регистрацией, входом и проверкой токена пользователя.
  - **Безопасность**: хранит токен в `localStorage` и использует его в заголовках запросов для доступа к защищённым ресурсам.
  - **Упрощение компонентов**: компоненты `Register` и `Login` не содержат деталей реализации запросов, что делает их код более простым.

утилиты содержат всю логику взаимодействия с сервером, что позволяет легко вносить изменения в API без необходимости изменять компоненты.

## 6. Стили и их организация
`blocks` — содержит стили компонентов, организованные по методологии БЭМ (Блок, Элемент, Модификатор). Здесь каждая папка соответствует отдельному блоку, а внутри находятся стили этого блока.


