# Спринт 1. Задание 1 "Проект Mesto"

## Уровень 1. Проектирование

### Анализ приложения

0. *Предпосылки выбора архитектурного решения.*  Само по себе задание не дает ответа на вопрос "Почему проекту требуется переход на микрофронтенды?", но я считаю что понимание причин важно для выбора архитектурного решения, поэтому опишу тут предпосылки, которые я увидел. 

1. *Анализ функционала проекта.* Исходя из текущего функционала приложения (выкладываем набор фотографий, редактируем его, собираем лайки) можно предположить, что в дальнейшем приложение будет развиваться как социальная сеть. Это требует высокой скорости разработки и поставки нового функционала. К примеру сейчас нет возможности просматривать и лайкать фотки других пользователей, предполагаю, что эта возможность будет крайне востребована. Поддержка этого функционала потребует расширения api и создания новых компонентов, например списка друзей и ленты новостей. Также пользователи могут захотеть оставлять комментарии под фото и другие реакции кроме лайков. В перспективе может потребоваться более сложная логика определения наиболее популярных фото, уведомления о реакциях на фото, и пр.

2. *Анализ кодовой базы проекта*. Анализируя код приложения можно предположить, что возможны проблемы из-за высокой связности некоторых компонентов. Например запрос к API за информацией о пользователе и массиве карточек выполняется единожды, при монтировании. Эти действия не обязательно должны быть связаны, информация о пользователе может подгружаться на страницу отдельно от карточек. Компонент *PopupWithForm* используется многими другими компонентами, внесение изменений в него затрагивает всё приложение. 

3. *Анализ нефункциональных требований*. Судя по демо приложение работает на одной странице со всплывающими окнами. Нужно учесть, что легаси код уже существует, работает, им уже пользуются и к нему привыкли. Видимо команда проекта будет расти и делиться на команды поменьше (чтобы сохранить управляемость как минимум). Дизайн приложения должен иметь возможность изменяться. Для того, чтобы обеспечить оптимальный пользовательский опыт можно мониторить производительность приложения, может потребоваться кэширование данных пользователя или самих фото. Мониторинг на фронтенде также используется для выявления проблем с UX, и формирования понимая того с какими проблемами клиенты сталкиваются пользователи на своих устройствах.

4. *Опыт команды*. Команда умеет разрабатывать React приложения.

### Техническое решение

Исходя из перечисленных требований можно выделить проблемы проекта:
- Тесная связность компонентов затрудняет разработку нового функционала и способствует возникновению багов 
- Растущей команде сложно вносить изменения, из-за того, что сложностей интеграции компонентов
- Вероятно было бы удобно настраивать отладку, логирование и мониторинг индивидуально для разных компонентов приложения

Для решения этих проблем предлагается провести четкие архитектурные границы между компонентами приложения, осуществив переход на микрофронтенды. Разделение предполагается выполнить исходя из принципов вертикальной нарезки:
- **cards** работа с фото (карточками) 
- **profile** работа с профилем пользователя
- **auth** аутентификация и авторизация 
- другие

Для реализации предлагается использовать фреймворк **Single SPA**, это позволит:
1. Разбить большую команду разработчиков на небольшие команды, занимающиеся отдельными функциями и разрабатывать их относительно независимо, что должно ускорить разработку новых фич и упростить интеграцию
2. Использовать наиболее подходящие технологии для различных компонентов, в том числе средства мониторинга логирования там где они необходимы
3. Внедрять изменения в проект поэтапно, так как компоненты разрабатываются изолированно друг от друга

**Клиентская композиция** и соответственно **интеграция компонентов в run-time**, позволят обеспечить богатый пользовательский опыт за счет повышения динамики обновления компонентов, а также сделают обновление компонентов независимым, что может быть важным для приложения, которое должно отображать набор фотографий.

Для коммуникации между микрофронтендами можно использовать **шину событий** и паттерны **Pub/Sub**, что позволит сохранить независимость при взаимодействии между компонентами, а также настроить централизованные системы логирования и мониторинга.

Так как выбран фреймворк **Single SPA**, маршрутизацию целесообразно выполнять на стороне клиента, это не потребует больших усилий от разработчиков и в некоторой степени должно улучшить клиентский опыт.

## Уровень 2. Планирование изменений

Предлагается следующая структура компонентов микрофронтендов:
- Приложение **cards** отвечает за редактирование карточек (фотографий) и включает компоненты:
  - *AddPlacePopup* и  - добавление карточки
  - *Card* - интерфейс для работы с карточками
  - *ImagePopup* - отображение карточки

- Приложение **profile** выполняет работу с профилем пользователя
  - *EditProfilePopup* - редактирование профиля
  - *EditAvatarPopup* - редактирование аватара

- Приложение **auth** отвечает за авторизацию пользователей
  - *Login* - отправка логина и пароля
  - *InfoTooltip* - результат авторизации
  - *Register* - регистрация нового пользователя

- Приложение **root**
  - *Header* - но нужно избавиться от зависимостей от компонентов auth и оставить только маршрутизацию 
  - *Footer*

- Общие библиотеки приложений (если объем общих компонентов увеличится, то можно рассмотреть возможность использование фреймворка **ModuleFederation**)
  - *PopupWithForm*


## Уровень 3. Запуск готового кода

Этот уровень пропущу, так как не слишком хорош в javascript (пишу эмбедед на C++)


# Спринт 1. Задание 2 "Проект Mesto"